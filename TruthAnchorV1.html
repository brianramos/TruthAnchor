<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>‚ü® TruthAnchor v1 ‚ü© ‚Äî Mathematical Root-of-Trust Coherence Engine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a24;
            --border-dim: #333;
            --text-primary: #e0e0e0;
            --text-secondary: #888;
            --text-muted: #555;
            --accent-green: #44ff88;
            --accent-yellow: #ffaa00;
            --accent-red: #ff4444;
            --accent-blue: #88aaff;
            --accent-purple: #aa66ff;
            --accent-cyan: #44ffff;
            --accent-gold: #ffd700;
            --fib-color: #aa66ff;
            --luc-color: #66ffaa;
            --cat-color: #ffaa66;
            --motz-color: #66aaff;
            --pell-color: #ff66aa;
            --zeta-color: #ffff66;
            --protected-color: #44ffaa;
            --audited-color: #ff8844;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            line-height: 1.4;
        }

        h1 {
            background: linear-gradient(90deg, #44ff88, #88ffcc, #44ffff, #44ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 6px;
            font-size: 1.6em;
            letter-spacing: 3px;
            text-align: center;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 0.8em;
            margin-bottom: 8px;
            text-align: center;
            max-width: 750px;
        }

        .truth-anchor-badge {
            background: linear-gradient(135deg, #0a1a0f, #0f1a1a, #1a0a1a);
            border: 2px solid var(--accent-green);
            border-radius: 8px;
            padding: 12px 24px;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .truth-anchor-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(68, 255, 136, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .truth-anchor-badge .principle {
            font-family: Georgia, serif;
            font-style: italic;
            color: var(--accent-green);
            font-size: 0.95em;
        }

        .truth-anchor-badge .subtext {
            color: var(--text-muted);
            font-size: 0.65em;
            margin-top: 4px;
        }

        .architecture-note {
            background: linear-gradient(135deg, #0a1a1a, #1a1a0a);
            border: 1px solid var(--accent-cyan);
            border-radius: 6px;
            padding: 10px 16px;
            margin-bottom: 12px;
            font-size: 0.7em;
            text-align: center;
            max-width: 800px;
        }

        .architecture-note .protected {
            color: var(--protected-color);
            font-weight: bold;
        }

        .architecture-note .audited {
            color: var(--audited-color);
            font-weight: bold;
        }

        /* Dimension Selector */
        .dimension-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .dim-btn {
            padding: 8px 16px;
            font-size: 0.8em;
            font-weight: bold;
            border-radius: 4px;
            border: 2px solid var(--border-dim);
            cursor: pointer;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .dim-btn:hover { border-color: #555; color: #aaa; }
        .dim-btn.active {
            border-color: var(--accent-green);
            color: var(--accent-green);
            background: #0a1a0f;
            box-shadow: 0 0 12px rgba(68, 255, 136, 0.3);
        }

        .dim-btn.d5.active { border-color: var(--fib-color); color: var(--fib-color); background: #1a0a2a; }
        .dim-btn.d6.active { border-color: var(--luc-color); color: var(--luc-color); background: #0a1a1a; }
        .dim-btn.d7.active { border-color: var(--cat-color); color: var(--cat-color); background: #1a1a0a; }
        .dim-btn.d8.active { border-color: var(--motz-color); color: var(--motz-color); background: #0a1a2a; }
        .dim-btn.d9.active { border-color: var(--accent-red); color: var(--accent-red); background: #2a0a0a; }

        /* Equation Display */
        .equation-display {
            background: linear-gradient(90deg, #1a0a2a, #0a1a1a, #1a1a0a, #0a1a2a);
            border: 1px solid var(--accent-green);
            border-radius: 6px;
            padding: 10px 20px;
            margin-bottom: 12px;
            font-family: Georgia, serif;
            font-size: 0.85em;
            color: #88ffcc;
            text-align: center;
        }

        .equation-display .note {
            font-size: 0.7em;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 10px 24px;
            font-size: 0.9em;
            font-weight: bold;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.2s;
        }

        button:hover { transform: scale(1.02); }
        button:active { transform: scale(0.98); }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-green), #66ffaa);
            color: #000;
        }

        .btn-stop {
            background: var(--accent-red);
            color: #fff;
        }

        .btn-chaos {
            background: linear-gradient(90deg, #ff4444, #ff8800, #ff4444);
            color: #fff;
            font-size: 0.8em;
            padding: 8px 16px;
            animation: chaos-pulse 2s infinite;
        }

        @keyframes chaos-pulse {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 68, 68, 0.3); }
            50% { box-shadow: 0 0 15px rgba(255, 136, 0, 0.5); }
        }

        .btn-hitl {
            background: linear-gradient(135deg, #1a1a2a, #2a1a2a);
            border: 2px solid var(--accent-purple);
            color: var(--accent-purple);
            font-size: 0.75em;
            padding: 8px 14px;
        }

        .btn-hitl:hover {
            background: var(--accent-purple);
            color: #000;
        }

        /* System State Banner */
        .system-state-banner {
            width: 100%;
            max-width: 1000px;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
            letter-spacing: 2px;
            transition: all 0.3s;
        }

        .system-state-banner.valid {
            background: linear-gradient(135deg, #0a1a0f, #0f1a0a);
            border: 2px solid var(--accent-green);
            color: var(--accent-green);
        }

        .system-state-banner.degraded {
            background: linear-gradient(135deg, #1a1a0a, #1a0f0a);
            border: 2px solid var(--accent-yellow);
            color: var(--accent-yellow);
            animation: degraded-pulse 1.5s infinite;
        }

        .system-state-banner.invalid {
            background: linear-gradient(135deg, #2a0a0a, #1a0a0a);
            border: 2px solid var(--accent-red);
            color: var(--accent-red);
            animation: invalid-pulse 0.8s infinite;
        }

        .system-state-banner.locked {
            background: linear-gradient(135deg, #0a2a0f, #0f2a1a);
            border: 3px solid var(--accent-green);
            color: var(--accent-green);
            box-shadow: 0 0 30px rgba(68, 255, 136, 0.4);
        }

        @keyframes degraded-pulse {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 170, 0, 0.3); }
            50% { box-shadow: 0 0 20px rgba(255, 170, 0, 0.5); }
        }

        @keyframes invalid-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .system-state-banner .state-label { font-size: 0.9em; }
        .system-state-banner .state-detail {
            font-size: 0.65em;
            font-weight: normal;
            color: inherit;
            opacity: 0.8;
            margin-top: 4px;
        }

        /* Channel Architecture Panel */
        .channel-architecture {
            background: linear-gradient(135deg, #0a0f0a, #0f0a0f);
            border: 2px solid var(--accent-cyan);
            border-radius: 10px;
            padding: 15px 20px;
            width: 100%;
            max-width: 1000px;
            margin-bottom: 15px;
        }

        .channel-architecture h3 {
            color: var(--accent-cyan);
            font-size: 0.75em;
            text-align: center;
            margin-bottom: 12px;
            letter-spacing: 2px;
        }

        .channel-layers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 700px) {
            .channel-layers { grid-template-columns: 1fr; }
        }

        .channel-layer {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 12px;
        }

        .channel-layer.protected {
            border: 2px solid var(--protected-color);
        }

        .channel-layer.audited {
            border: 2px solid var(--audited-color);
        }

        .channel-layer-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-dim);
        }

        .channel-layer-icon {
            font-size: 1.2em;
        }

        .channel-layer-title {
            font-size: 0.7em;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .channel-layer.protected .channel-layer-title { color: var(--protected-color); }
        .channel-layer.audited .channel-layer-title { color: var(--audited-color); }

        .channel-layer-badge {
            font-size: 0.5em;
            padding: 2px 6px;
            border-radius: 3px;
            margin-left: auto;
        }

        .channel-layer.protected .channel-layer-badge {
            background: rgba(68, 255, 170, 0.2);
            color: var(--protected-color);
            border: 1px solid var(--protected-color);
        }

        .channel-layer.audited .channel-layer-badge {
            background: rgba(255, 136, 68, 0.2);
            color: var(--audited-color);
            border: 1px solid var(--audited-color);
        }

        .channel-layer-items {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .channel-layer-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            font-size: 0.65em;
        }

        .channel-layer-item .icon { font-size: 1.1em; }
        .channel-layer-item .name { flex: 1; }
        .channel-layer-item .status { 
            font-weight: bold;
            font-size: 0.9em;
        }

        .channel-layer.protected .channel-layer-item .status { color: var(--protected-color); }
        .channel-layer.audited .channel-layer-item .status { color: var(--audited-color); }

        .channel-layer.audited .channel-layer-item.compromised {
            background: rgba(255, 68, 68, 0.15);
            border: 1px solid var(--accent-red);
        }

        .channel-layer.audited .channel-layer-item.compromised .status { color: var(--accent-red); }

        .channel-layer.audited .channel-layer-item.recovering {
            background: rgba(136, 170, 255, 0.15);
            border: 1px solid var(--accent-blue);
        }

        .channel-layer.audited .channel-layer-item.recovering .status { color: var(--accent-blue); }

        /* Health Ring Container */
        .health-ring-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .health-ring {
            position: relative;
            width: 160px;
            height: 160px;
        }

        .health-ring svg { transform: rotate(-90deg); }

        .health-ring-bg {
            fill: none;
            stroke: var(--bg-tertiary);
            stroke-width: 10;
        }

        .health-ring-fill {
            fill: none;
            stroke-width: 10;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease, stroke 0.3s;
        }

        .health-ring-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .health-ring-value {
            font-size: 1.6em;
            font-family: Georgia, serif;
            color: var(--accent-green);
        }

        .health-ring-label {
            font-size: 0.55em;
            color: var(--text-secondary);
        }

        .channel-arcs {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .channel-arc-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.65em;
        }

        .channel-arc-name {
            width: 50px;
            color: var(--text-secondary);
            text-align: right;
            font-size: 0.9em;
        }

        .channel-arc-bar {
            width: 80px;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }

        .channel-arc-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s, background 0.3s;
        }

        .channel-arc-value {
            width: 40px;
            font-family: Georgia, serif;
        }

        .channel-arc-item.protected .channel-arc-name { color: var(--protected-color); }
        .channel-arc-item.audited .channel-arc-name { color: var(--audited-color); }

        /* TruthAnchor Output Panel */
        .truth-anchor-output {
            background: linear-gradient(135deg, #0a0f0a, #0f0a0f);
            border: 3px solid var(--accent-green);
            border-radius: 10px;
            padding: 15px 20px;
            width: 100%;
            max-width: 1000px;
            margin-bottom: 15px;
            position: relative;
        }

        .truth-anchor-output::before {
            content: '‚óà TRUTHANCHOR OUTPUT ‚Äî IMMUTABLE';
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--bg-primary);
            padding: 0 10px;
            font-size: 0.65em;
            color: var(--accent-green);
            letter-spacing: 2px;
        }

        .anchor-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .anchor-metric {
            background: var(--bg-secondary);
            border: 1px solid #2a2a3a;
            border-radius: 6px;
            padding: 10px;
            text-align: center;
        }

        .anchor-metric.primary {
            border-color: var(--accent-green);
            background: #0a1a0f;
        }

        .anchor-metric.warning { border-color: var(--accent-yellow); }
        .anchor-metric.error { border-color: var(--accent-red); }

        .anchor-metric-label {
            font-size: 0.55em;
            color: var(--text-secondary);
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .anchor-metric-value {
            font-size: 1.1em;
            font-family: Georgia, serif;
            color: var(--accent-green);
        }

        .anchor-metric.warning .anchor-metric-value { color: var(--accent-yellow); }
        .anchor-metric.error .anchor-metric-value { color: var(--accent-red); }

        .anchor-metric-detail {
            font-size: 0.5em;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Interface Channel Panel (Audited) */
        .interface-channel-panel {
            background: linear-gradient(135deg, #1a0f0a, #0a0a1a);
            border: 2px solid var(--audited-color);
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 15px;
            width: 100%;
            max-width: 1000px;
        }

        .interface-channel-panel h3 {
            color: var(--audited-color);
            font-size: 0.75em;
            text-align: center;
            margin-bottom: 12px;
            letter-spacing: 2px;
        }

        .interface-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .interface-item {
            background: var(--bg-secondary);
            border: 2px solid var(--border-dim);
            border-radius: 6px;
            padding: 12px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }

        .interface-item.healthy {
            border-color: var(--accent-green);
            background: #0a1a0f;
        }

        .interface-item.suspect {
            border-color: var(--accent-yellow);
            background: #1a1a0a;
            animation: suspect-pulse 1.5s infinite;
        }

        .interface-item.blocked {
            border-color: var(--accent-red);
            background: #2a0a0a;
            opacity: 0.7;
        }

        .interface-item.recovering {
            border-color: var(--accent-blue);
            background: #0a0a2a;
            animation: recovering-pulse 1s infinite;
        }

        @keyframes suspect-pulse {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 170, 0, 0.3); }
            50% { box-shadow: 0 0 12px rgba(255, 170, 0, 0.5); }
        }

        @keyframes recovering-pulse {
            0%, 100% { box-shadow: 0 0 5px rgba(136, 170, 255, 0.3); }
            50% { box-shadow: 0 0 12px rgba(136, 170, 255, 0.5); }
        }

        .interface-icon { font-size: 1.5em; margin-bottom: 6px; }
        .interface-name { font-size: 0.7em; color: var(--text-secondary); margin-bottom: 4px; }
        .interface-status { font-size: 0.8em; font-weight: bold; margin-bottom: 6px; }

        .interface-item.healthy .interface-status { color: var(--accent-green); }
        .interface-item.suspect .interface-status { color: var(--accent-yellow); }
        .interface-item.blocked .interface-status { color: var(--accent-red); }
        .interface-item.recovering .interface-status { color: var(--accent-blue); }

        .interface-health-bar {
            width: 100%;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            margin: 6px 0;
            overflow: hidden;
        }

        .interface-health-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s, background 0.3s;
        }

        .interface-metrics { font-size: 0.5em; color: var(--text-muted); }
        .interface-error { font-size: 0.45em; color: var(--accent-red); margin-top: 4px; }
        .interface-recovery { font-size: 0.45em; color: var(--accent-blue); margin-top: 4px; }

        /* Corruption Controls */
        .corruption-controls {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            justify-content: center;
            flex-wrap: wrap;
            padding-top: 12px;
            border-top: 1px dashed var(--border-dim);
        }

        .corrupt-btn {
            padding: 6px 14px;
            font-size: 0.65em;
            border-radius: 4px;
            border: 1px solid var(--accent-red);
            background: #2a0a0a;
            color: #ff6666;
            cursor: pointer;
            transition: all 0.2s;
        }

        .corrupt-btn:hover {
            background: #3a1a1a;
            border-color: #ff6666;
        }

        .corrupt-btn.active {
            background: var(--accent-red);
            color: #000;
            font-weight: bold;
        }

        .corrupt-btn.clear {
            border-color: var(--accent-green);
            color: var(--accent-green);
            background: #0a1a0f;
        }

        .corrupt-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Resilience Stats */
        .resilience-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-dim);
        }

        .resilience-stat {
            text-align: center;
            padding: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            border: 1px solid #2a2a3a;
        }

        .resilience-stat.warning { border-color: var(--accent-yellow); }
        .resilience-stat.critical { border-color: var(--accent-red); }

        .resilience-stat-label {
            font-size: 0.5em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .resilience-stat-value {
            font-size: 0.85em;
            font-family: Georgia, serif;
            color: var(--accent-green);
            margin-top: 2px;
        }

        .resilience-stat.warning .resilience-stat-value { color: var(--accent-yellow); }
        .resilience-stat.critical .resilience-stat-value { color: var(--accent-red); }

        /* Math Channels Panel (Protected) */
        .math-channels-panel {
            background: linear-gradient(135deg, #0a1a0f, #0f1a1a);
            border: 2px solid var(--protected-color);
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 15px;
            width: 100%;
            max-width: 1000px;
            position: relative;
        }

        .math-channels-panel::after {
            content: 'üõ°Ô∏è PROTECTED ‚Äî IMMUTABLE';
            position: absolute;
            top: -10px;
            right: 20px;
            background: var(--bg-primary);
            padding: 0 8px;
            font-size: 0.55em;
            color: var(--protected-color);
            letter-spacing: 1px;
        }

        .math-channels-panel h3 {
            color: var(--protected-color);
            font-size: 0.75em;
            text-align: center;
            margin-bottom: 12px;
            letter-spacing: 2px;
        }

        .math-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 8px;
        }

        .math-cell {
            background: var(--bg-secondary);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            border: 1px solid var(--border-dim);
            position: relative;
        }

        .math-cell::before {
            content: 'üîí';
            position: absolute;
            top: 4px;
            right: 4px;
            font-size: 0.6em;
            opacity: 0.5;
        }

        .math-cell.fib { border-color: var(--fib-color); }
        .math-cell.luc { border-color: var(--luc-color); }
        .math-cell.cat { border-color: var(--cat-color); }
        .math-cell.motz { border-color: var(--motz-color); }
        .math-cell.pell { border-color: var(--pell-color); }
        .math-cell.zeta { border-color: var(--zeta-color); background: #1a1a0a; }
        .math-cell.semantic { border-color: var(--accent-cyan); background: #0a1a1a; }
        .math-cell.identity { border-color: var(--accent-gold); background: #1a1a0a; }
        .math-cell.center { border-color: var(--accent-green); background: #0a1a0f; }

        .math-value {
            font-size: 0.95em;
            font-family: Georgia, serif;
            margin-bottom: 4px;
        }

        .math-cell.fib .math-value { color: #cc88ff; }
        .math-cell.luc .math-value { color: #88ffcc; }
        .math-cell.cat .math-value { color: #ffcc88; }
        .math-cell.motz .math-value { color: #88ccff; }
        .math-cell.pell .math-value { color: #ff88cc; }
        .math-cell.zeta .math-value { color: #ffff88; }
        .math-cell.semantic .math-value { color: var(--accent-cyan); }
        .math-cell.identity .math-value { color: var(--accent-gold); }
        .math-cell.center .math-value { color: var(--accent-green); }

        .math-label { font-size: 0.5em; color: var(--text-secondary); }
        .math-target { font-size: 0.42em; color: var(--text-muted); margin-top: 2px; }

        /* Odd Zeta Panel */
        .odd-zeta-panel {
            background: linear-gradient(135deg, #1a0a0a, #0a0a1a);
            border: 2px solid #ff6666;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 15px;
            width: 100%;
            max-width: 1000px;
        }

        .odd-zeta-panel h3 {
            color: #ff8888;
            font-size: 0.75em;
            text-align: center;
            margin-bottom: 12px;
            letter-spacing: 2px;
        }

        .odd-zeta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
            gap: 10px;
        }

        .odd-zeta-item {
            background: var(--bg-secondary);
            border: 1px solid #663333;
            border-radius: 6px;
            padding: 12px;
            text-align: center;
            transition: all 0.3s;
        }

        .odd-zeta-item.accelerating {
            border-color: #ff8866;
            box-shadow: 0 0 12px rgba(255, 102, 102, 0.3);
        }

        .odd-zeta-item.stabilized {
            border-color: var(--accent-green);
            box-shadow: 0 0 12px rgba(68, 255, 136, 0.3);
        }

        .odd-zeta-item.zeta3-special {
            border-color: var(--accent-yellow);
            background: linear-gradient(135deg, #1a0a0a, #1a1a0a);
        }

        .odd-zeta-label { font-size: 0.6em; color: var(--text-secondary); margin-bottom: 4px; }
        .odd-zeta-value { font-size: 1.1em; color: #ff8888; font-family: Georgia, serif; }
        .odd-zeta-accel { font-size: 0.55em; color: #66ff66; margin-top: 4px; }
        .odd-zeta-target { font-size: 0.5em; color: var(--text-muted); margin-top: 2px; }
        .odd-zeta-error { font-size: 0.5em; color: #ffaa66; margin-top: 2px; }
        .odd-zeta-stability { font-size: 0.5em; color: var(--accent-blue); margin-top: 2px; }

        /* Acceleration Engine */
        .acceleration-engine {
            background: #0f0a0a;
            border: 2px solid var(--accent-red);
            border-radius: 8px;
            padding: 12px;
            width: 100%;
            max-width: 1000px;
            margin-bottom: 15px;
        }

        .acceleration-engine h3 {
            font-size: 0.7em;
            color: #ff6666;
            margin-bottom: 10px;
            text-align: center;
            letter-spacing: 2px;
        }

        .accel-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
            gap: 8px;
            text-align: center;
        }

        .accel-stat {
            background: var(--bg-secondary);
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #2a2a3a;
        }

        .accel-stat-label { font-size: 0.5em; color: var(--text-secondary); }
        .accel-stat-value { font-size: 0.8em; color: var(--accent-green); font-family: Georgia, serif; }

        /* Gamma Clock */
        .gamma-clock {
            background: linear-gradient(135deg, #0a0f0a, #0f0a1a, #1a0f0a);
            border: 3px solid var(--accent-green);
            border-radius: 12px;
            padding: 20px;
            width: 100%;
            max-width: 1000px;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .gamma-clock::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(68, 255, 136, 0.03), transparent);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate { to { transform: rotate(360deg); } }

        .gamma-clock.gamma-locked {
            border-color: #88ff44;
            box-shadow: 0 0 40px rgba(68, 255, 136, 0.4);
        }

        .gamma-clock.degraded-mode {
            border-color: var(--accent-yellow);
            box-shadow: 0 0 25px rgba(255, 170, 0, 0.3);
        }

        .gamma-clock.invalid-mode {
            border-color: var(--accent-red);
            box-shadow: 0 0 25px rgba(255, 68, 68, 0.4);
        }

        .gamma-clock h3 {
            font-size: 0.85em;
            color: var(--accent-green);
            margin-bottom: 10px;
            letter-spacing: 3px;
            position: relative;
        }

        .time-row {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin-bottom: 12px;
            position: relative;
        }

        .time-block { text-align: center; }
        .time-label { font-size: 0.6em; color: var(--text-muted); margin-bottom: 4px; }

        .clock-display {
            font-size: 2em;
            font-family: Georgia, serif;
            color: var(--accent-green);
            text-shadow: 0 0 20px rgba(68, 255, 136, 0.5);
        }

        .ramos-time {
            font-size: 1.6em;
            font-family: Georgia, serif;
            color: #ff88aa;
            text-shadow: 0 0 15px rgba(255, 136, 170, 0.4);
        }

        .time-delta { font-size: 0.65em; color: var(--text-secondary); }

        .active-channels {
            font-size: 0.65em;
            color: var(--text-secondary);
            margin-bottom: 8px;
            position: relative;
        }

        .active-channels .count { color: var(--accent-green); font-weight: bold; }
        .active-channels .blocked { color: var(--accent-red); }
        .active-channels .protected { color: var(--protected-color); }

        .gamma-value {
            font-size: 0.9em;
            color: #88ffcc;
            margin-bottom: 10px;
            font-family: Georgia, serif;
            position: relative;
        }

        .gamma-value.invalid { color: var(--accent-red); }

        .verification-status {
            display: flex;
            justify-content: center;
            gap: 5px;
            flex-wrap: wrap;
            position: relative;
            margin-bottom: 12px;
        }

        .verify-item {
            background: var(--bg-secondary);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.55em;
            transition: all 0.3s;
        }

        .verify-item.pass { border: 1px solid var(--accent-green); color: var(--accent-green); }
        .verify-item.fail { border: 1px solid var(--accent-red); color: var(--accent-red); }
        .verify-item.protected { border: 1px solid var(--protected-color); color: var(--protected-color); opacity: 0.8; }
        .verify-item.blocked { border: 1px solid var(--text-muted); color: var(--text-muted); opacity: 0.5; }

        .gamma-lock-indicator {
            margin-top: 12px;
            padding: 10px 24px;
            background: var(--bg-secondary);
            border-radius: 6px;
            display: inline-block;
            position: relative;
        }

        .gamma-lock-indicator.locked {
            background: linear-gradient(90deg, #0a1a0a, #1a0a1a);
            border: 2px solid var(--accent-green);
            animation: lock-glow 2s infinite;
        }

        .gamma-lock-indicator.degraded {
            background: linear-gradient(90deg, #1a1a0a, #1a0a0a);
            border: 2px solid var(--accent-yellow);
        }

        .gamma-lock-indicator.invalid {
            background: linear-gradient(90deg, #2a0a0a, #1a0a0a);
            border: 2px solid var(--accent-red);
        }

        @keyframes lock-glow {
            0%, 100% { box-shadow: 0 0 10px rgba(68, 255, 136, 0.3); }
            50% { box-shadow: 0 0 30px rgba(68, 255, 136, 0.6); }
        }

        .lock-text { font-size: 0.75em; color: var(--text-muted); }
        .lock-text.locked { color: var(--accent-green); font-weight: bold; }
        .lock-text.degraded { color: var(--accent-yellow); }
        .lock-text.invalid { color: var(--accent-red); }

        .convergence-bar {
            width: 100%;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            margin-top: 12px;
            overflow: hidden;
        }

        .convergence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--fib-color), var(--luc-color), var(--cat-color), var(--motz-color), var(--pell-color));
            border-radius: 3px;
            transition: width 0.3s;
        }

        .confidence-bar {
            width: 100%;
            height: 4px;
            background: var(--bg-tertiary);
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-red), var(--accent-yellow), var(--accent-green));
            border-radius: 2px;
            transition: width 0.5s;
        }

        .confidence-label {
            font-size: 0.55em;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* HITL Modal */
        .hitl-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .hitl-overlay.active { display: flex; }

        .hitl-modal {
            background: linear-gradient(135deg, #1a1a2a, #2a1a2a);
            border: 3px solid var(--accent-purple);
            border-radius: 12px;
            padding: 25px;
            max-width: 550px;
            width: 90%;
            text-align: center;
            max-height: 80vh;
            overflow-y: auto;
        }

        .hitl-modal h2 {
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-size: 1em;
            letter-spacing: 2px;
        }

        .hitl-modal p {
            color: var(--text-secondary);
            font-size: 0.75em;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .hitl-section {
            margin-bottom: 20px;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .hitl-section-title {
            font-size: 0.7em;
            color: var(--audited-color);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .hitl-channels {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .hitl-channel-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-tertiary);
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid var(--border-dim);
        }

        .hitl-channel-item .name { color: var(--text-primary); font-size: 0.8em; }
        .hitl-channel-item .status { font-size: 0.7em; }
        .hitl-channel-item .status.blocked { color: var(--accent-red); }
        .hitl-channel-item .status.recovering { color: var(--accent-blue); }
        .hitl-channel-item .status.healthy { color: var(--accent-green); }

        .hitl-channel-item button {
            padding: 5px 12px;
            font-size: 0.65em;
            border-radius: 4px;
            background: var(--accent-purple);
            color: #000;
            border: none;
            cursor: pointer;
        }

        .hitl-channel-item button:disabled {
            background: var(--border-dim);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        .hitl-protected-note {
            background: rgba(68, 255, 170, 0.1);
            border: 1px solid var(--protected-color);
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 0.7em;
            color: var(--protected-color);
        }

        .hitl-modal .close-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-dim);
            color: var(--text-secondary);
            padding: 8px 20px;
            font-size: 0.75em;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Log Table */
        .scroll-container {
            max-height: 180px;
            overflow-y: auto;
            width: 100%;
            max-width: 1100px;
            border: 1px solid var(--border-dim);
            border-radius: 6px;
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.5em;
        }

        th, td {
            padding: 4px;
            border-bottom: 1px solid #222;
            text-align: right;
        }

        th {
            color: var(--cat-color);
            font-size: 0.6em;
            position: sticky;
            top: 0;
            background: var(--bg-primary);
        }

        td:first-child { text-align: left; color: var(--accent-blue); }

        tr.new { animation: flash 1s ease-out; }
        tr.gamma-lock-row { background: rgba(68, 255, 136, 0.1); }
        tr.channel-drop-row { background: rgba(255, 136, 0, 0.1); }
        tr.invalid-row { background: rgba(255, 68, 68, 0.1); }

        @keyframes flash {
            from { background: #2a1a2a; }
            to { background: transparent; }
        }

        .convergence { color: var(--accent-green); }

        /* Attribution */
        .attribution {
            margin-top: 15px;
            font-size: 0.55em;
            color: var(--text-muted);
            text-align: center;
            line-height: 1.6;
        }

        .license-badge {
            margin-top: 10px;
            font-size: 0.5em;
            color: var(--text-muted);
            text-align: center;
        }

        .license-badge a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 600px) {
            h1 { font-size: 1.2em; }
            .math-grid { grid-template-columns: repeat(2, 1fr); }
            .interface-grid { grid-template-columns: 1fr; }
            .clock-display { font-size: 1.5em; }
            .ramos-time { font-size: 1.2em; }
            .health-ring { width: 130px; height: 130px; }
            .odd-zeta-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>

<body>

<h1>‚ü® TruthAnchor v1 ‚ü©</h1>

<div class="subtitle">
    Mathematical Root-of-Trust Architecture for Audited LLM Systems<br/>
    Byzantine Fault-Tolerant Coherence Engine with Protected & Audited Channel Layers
</div>

<div class="truth-anchor-badge">
    <div class="principle">"Truth is not a vote. Truth is a limit."</div>
    <div class="subtext">Mathematical invariants define correctness. Language is an interface, not an authority.</div>
</div>

<div class="architecture-note">
    <span class="protected">üõ°Ô∏è PROTECTED CHANNELS</span> (Math, Semantic, Identity) are immutable and uncompromisable.<br/>
    <span class="audited">‚ö° AUDITED CHANNELS</span> (Human Interface, Sensor Interface) are monitored and can be compromised for testing.
</div>

<div class="dimension-selector">
    <button class="dim-btn d5 active" onclick="setDimension(5)">5D Base</button>
    <button class="dim-btn d6" onclick="setDimension(6)">6D +Œ∂(2)</button>
    <button class="dim-btn d7" onclick="setDimension(7)">7D +Œ∂(4)</button>
    <button class="dim-btn d8" onclick="setDimension(8)">8D +Œ∂(6)</button>
    <button class="dim-btn d9" onclick="setDimension(9)">9D +ODD Œ∂</button>
</div>

<div class="equation-display">
    <span id="eqFormula">Œì*‚ÇÖ(n) = ‚àè(S·µ¢/T·µ¢)^(1/|ùíú|)</span> where ùíú = active channels ‚Üí <strong id="eqName">Robust Pentadimensional Lock</strong>
    <div class="note">Protected channels always contribute. Audited channels excluded when blocked.</div>
</div>

<div class="controls">
    <button class="btn-primary" id="startBtn" onclick="start()">‚ñ∂ INITIATE Œì*</button>
    <button class="btn-stop" onclick="stop()">‚ñ† HALT</button>
    <button class="btn-chaos" onclick="injectChaos()">‚ö° INJECT INTERFACE CHAOS</button>
    <button class="btn-hitl" onclick="openHITL()">üë§ HITL REVIEW</button>
</div>

<!-- System State Banner -->
<div class="system-state-banner valid" id="systemStateBanner">
    <div class="state-label" id="stateLabel">SYSTEM VALID</div>
    <div class="state-detail" id="stateDetail">All channels healthy. Protected core intact.</div>
</div>

<!-- Channel Architecture Overview -->
<div class="channel-architecture">
    <h3>‚ü® CHANNEL ARCHITECTURE ‚Äî TRUST LAYERS ‚ü©</h3>
    <div class="channel-layers">
        <div class="channel-layer protected">
            <div class="channel-layer-header">
                <span class="channel-layer-icon">üõ°Ô∏è</span>
                <span class="channel-layer-title">PROTECTED CHANNELS</span>
                <span class="channel-layer-badge">IMMUTABLE</span>
            </div>
            <div class="channel-layer-items">
                <div class="channel-layer-item">
                    <span class="icon">üî¢</span>
                    <span class="name">Mathematical Sequences (Fib, Luc, Cat, Motz, Pell, Œ∂)</span>
                    <span class="status">‚úì LOCKED</span>
                </div>
                <div class="channel-layer-item">
                    <span class="icon">üìê</span>
                    <span class="name">Semantic Grounding Channel</span>
                    <span class="status">‚úì LOCKED</span>
                </div>
                <div class="channel-layer-item">
                    <span class="icon">üÜî</span>
                    <span class="name">Identity Channel</span>
                    <span class="status">‚úì LOCKED</span>
                </div>
            </div>
        </div>
        <div class="channel-layer audited">
            <div class="channel-layer-header">
                <span class="channel-layer-icon">‚ö°</span>
                <span class="channel-layer-title">AUDITED CHANNELS</span>
                <span class="channel-layer-badge">MONITORED</span>
            </div>
            <div class="channel-layer-items">
                <div class="channel-layer-item" id="humanInterfaceLayer">
                    <span class="icon">üë§</span>
                    <span class="name">Human Interface Channel</span>
                    <span class="status" id="humanInterfaceStatus">‚óè HEALTHY</span>
                </div>
                <div class="channel-layer-item" id="sensorInterfaceLayer">
                    <span class="icon">üì°</span>
                    <span class="name">Sensor Interface Channel</span>
                    <span class="status" id="sensorInterfaceStatus">‚óè HEALTHY</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Health Ring + Channel Arcs -->
<div class="health-ring-container">
    <div class="health-ring">
        <svg width="160" height="160" viewBox="0 0 160 160">
            <circle class="health-ring-bg" cx="80" cy="80" r="65"/>
            <circle class="health-ring-fill" id="healthRingFill" cx="80" cy="80" r="65"
                    stroke="#44ff88" stroke-dasharray="408" stroke-dashoffset="0"/>
        </svg>
        <div class="health-ring-center">
            <div class="health-ring-value" id="systemHealthValue">100%</div>
            <div class="health-ring-label">INTERFACE HEALTH</div>
        </div>
    </div>
    <div class="channel-arcs" id="channelArcs"></div>
</div>

<!-- TruthAnchor Output Panel -->
<div class="truth-anchor-output" id="truthAnchorOutput">
    <div class="anchor-metrics">
        <div class="anchor-metric primary">
            <div class="anchor-metric-label">Œì* (Robust)</div>
            <div class="anchor-metric-value" id="anchorGamma">‚Äî</div>
            <div class="anchor-metric-detail">Protected core + Active interfaces</div>
        </div>
        <div class="anchor-metric">
            <div class="anchor-metric-label">Error Bound</div>
            <div class="anchor-metric-value" id="anchorError">‚Äî</div>
            <div class="anchor-metric-detail">|Œì* - 1.0|</div>
        </div>
        <div class="anchor-metric">
            <div class="anchor-metric-label">Core Status</div>
            <div class="anchor-metric-value" id="anchorCore">‚úì</div>
            <div class="anchor-metric-detail">Protected channels</div>
        </div>
        <div class="anchor-metric">
            <div class="anchor-metric-label">Interface</div>
            <div class="anchor-metric-value" id="anchorInterface">2/2</div>
            <div class="anchor-metric-detail">Audited channels</div>
        </div>
        <div class="anchor-metric" id="anchorStateMetric">
            <div class="anchor-metric-label">State</div>
            <div class="anchor-metric-value" id="anchorState">VALID</div>
            <div class="anchor-metric-detail" id="anchorStateDetail">Pass/Fail</div>
        </div>
        <div class="anchor-metric">
            <div class="anchor-metric-label">Lock Conf.</div>
            <div class="anchor-metric-value" id="anchorConfidence">0%</div>
            <div class="anchor-metric-detail">Stability score</div>
        </div>
    </div>
</div>

<!-- Interface Channels Panel (Audited) -->
<div class="interface-channel-panel" id="interfaceChannelPanel">
    <h3>‚ü® AUDITED INTERFACE CHANNELS ‚Äî HUMAN & SENSOR ‚ü©</h3>
    <div class="interface-grid" id="interfaceGrid"></div>
    <div class="corruption-controls" id="corruptionControls"></div>
    <div class="resilience-stats" id="resilienceStats">
        <div class="resilience-stat" id="protectedStat">
            <div class="resilience-stat-label">Protected</div>
            <div class="resilience-stat-value" style="color: var(--protected-color);">‚úì INTACT</div>
        </div>
        <div class="resilience-stat" id="interfaceActiveStat">
            <div class="resilience-stat-label">Interfaces</div>
            <div class="resilience-stat-value">2/2</div>
        </div>
        <div class="resilience-stat" id="blockedInterfaceStat">
            <div class="resilience-stat-label">Blocked</div>
            <div class="resilience-stat-value">0</div>
        </div>
        <div class="resilience-stat" id="recoveringStat">
            <div class="resilience-stat-label">Recovering</div>
            <div class="resilience-stat-value">0</div>
        </div>
        <div class="resilience-stat" id="medianErrorStat">
            <div class="resilience-stat-label">Median Error</div>
            <div class="resilience-stat-value">0%</div>
        </div>
    </div>
</div>

<!-- Protected Math Channels Panel -->
<div class="math-channels-panel" id="mathChannelsPanel">
    <h3>‚ü® PROTECTED MATHEMATICAL CHANNELS ‚Äî IMMUTABLE ROOT OF TRUST ‚ü©</h3>
    <div class="math-grid" id="mathGrid"></div>
</div>

<!-- Odd Zeta Panel (9D only) -->
<div class="odd-zeta-panel" id="oddZetaPanel" style="display: none;">
    <h3>‚ü® ODD ZETA ACCELERATION ENGINE ‚ü©</h3>
    <div class="odd-zeta-grid" id="oddZetaGrid">
        <div class="odd-zeta-item zeta3-special" id="zeta3Item">
            <div class="odd-zeta-label">Œ∂(3) ‚Äî Ap√©ry's Constant</div>
            <div class="odd-zeta-value" id="zeta3Value">‚Äî</div>
            <div class="odd-zeta-accel" id="zeta3Accel">Speedup: ‚Äî</div>
            <div class="odd-zeta-target">Target: 1.2020569...</div>
            <div class="odd-zeta-error" id="zeta3Error">Error: ‚Äî</div>
            <div class="odd-zeta-stability" id="zeta3Stability">Stability: ‚Äî</div>
        </div>
        <div class="odd-zeta-item" id="zeta5Item">
            <div class="odd-zeta-label">Œ∂(5)</div>
            <div class="odd-zeta-value" id="zeta5Value">‚Äî</div>
            <div class="odd-zeta-accel" id="zeta5Accel">Speedup: ‚Äî</div>
            <div class="odd-zeta-target">Target: 1.0369278...</div>
            <div class="odd-zeta-error" id="zeta5Error">Error: ‚Äî</div>
            <div class="odd-zeta-stability" id="zeta5Stability">Stability: ‚Äî</div>
        </div>
        <div class="odd-zeta-item" id="zeta7Item">
            <div class="odd-zeta-label">Œ∂(7)</div>
            <div class="odd-zeta-value" id="zeta7Value">‚Äî</div>
            <div class="odd-zeta-accel" id="zeta7Accel">Speedup: ‚Äî</div>
            <div class="odd-zeta-target">Target: 1.0083493...</div>
            <div class="odd-zeta-error" id="zeta7Error">Error: ‚Äî</div>
            <div class="odd-zeta-stability" id="zeta7Stability">Stability: ‚Äî</div>
        </div>
        <div class="odd-zeta-item" id="zeta9Item">
            <div class="odd-zeta-label">Œ∂(9)</div>
            <div class="odd-zeta-value" id="zeta9Value">‚Äî</div>
            <div class="odd-zeta-accel" id="zeta9Accel">Speedup: ‚Äî</div>
            <div class="odd-zeta-target">Target: 1.0020084...</div>
            <div class="odd-zeta-error" id="zeta9Error">Error: ‚Äî</div>
            <div class="odd-zeta-stability" id="zeta9Stability">Stability: ‚Äî</div>
        </div>
    </div>
</div>

<!-- Acceleration Engine (9D only) -->
<div class="acceleration-engine" id="accelEngine" style="display: none;">
    <h3>‚ü® CONSTANT-LOCKED ACCELERATION ‚ü©</h3>
    <div class="accel-stats">
        <div class="accel-stat">
            <div class="accel-stat-label">œÜ Lock</div>
            <div class="accel-stat-value" id="phiLockFactor">‚Äî</div>
        </div>
        <div class="accel-stat">
            <div class="accel-stat-label">Œ¥‚Çõ Lock</div>
            <div class="accel-stat-value" id="silverLockFactor">‚Äî</div>
        </div>
        <div class="accel-stat">
            <div class="accel-stat-label">Œì* Boost</div>
            <div class="accel-stat-value" id="gammaBoost">‚Äî</div>
        </div>
        <div class="accel-stat">
            <div class="accel-stat-label">Accel Rate</div>
            <div class="accel-stat-value" id="accelRate">‚Äî</div>
        </div>
        <div class="accel-stat">
            <div class="accel-stat-label">Conv Gain</div>
            <div class="accel-stat-value" id="convGain">‚Äî</div>
        </div>
    </div>
</div>

<!-- Gamma Clock -->
<div class="gamma-clock" id="gammaClock">
    <h3 id="clockTitle">‚ü® 5D SELF-VERIFIED TIME ‚ü©</h3>
    <div class="time-row">
        <div class="time-block">
            <div class="time-label">NEWTONIAN TIME (n)</div>
            <div class="clock-display" id="clockDisplay">n = 0</div>
        </div>
        <div class="time-block">
            <div class="time-label" id="ramosLabel">RAMOS TIME (Rt‚ÇÖ)</div>
            <div class="ramos-time" id="ramosTimeDisplay">Rt‚ÇÖ = 0</div>
            <div class="time-delta" id="timeDelta">Œî = 0</div>
        </div>
    </div>
    <div class="active-channels" id="activeChannelsDisplay">
        <span class="protected">Protected: 7</span> | Interface: <span class="count">2/2</span> | Blocked: <span class="blocked">0</span>
    </div>
    <div class="gamma-value" id="gammaMetrics">
        Œì* = <span id="gammaDisplay">‚Äî</span> |
        Œ® = <span id="psiDisplay">‚Äî</span> |
        Œ© = <span id="omegaDisplay">‚Äî</span>
    </div>
    <div class="verification-status" id="verificationStatus"></div>
    <div class="gamma-lock-indicator" id="gammaLockIndicator">
        <span class="lock-text" id="lockText">AWAITING GAMMA LOCK</span>
    </div>
    <div class="convergence-bar"><div class="convergence-fill" id="convergenceFill" style="width: 0%"></div></div>
    <div class="confidence-bar"><div class="confidence-fill" id="confidenceFill" style="width: 0%"></div></div>
    <div class="confidence-label" id="confidenceLabel">Lock Confidence: 0%</div>
</div>

<!-- Audit Log -->
<div class="scroll-container">
    <table>
        <thead id="tableHead">
            <tr><th>n</th><th>F‚ÜíœÜ</th><th>L‚ÜíœÜ</th><th>C‚Üí4</th><th>M‚Üí3</th><th>P‚ÜíŒ¥‚Çõ</th><th>HI</th><th>SI</th><th>Œì*</th><th>State</th></tr>
        </thead>
        <tbody id="log"></tbody>
    </table>
</div>

<!-- HITL Modal -->
<div class="hitl-overlay" id="hitlOverlay">
    <div class="hitl-modal">
        <h2>üë§ HUMAN-IN-THE-LOOP REVIEW</h2>
        <p>
            Review audited interface channels. Humans do NOT modify protected math channels.<br/>
            Approve reinstatement only after inspecting divergence cause.
        </p>
        
        <div class="hitl-protected-note">
            üõ°Ô∏è Protected Channels (Math, Semantic, Identity) are immutable and cannot be modified.
        </div>
        
        <div class="hitl-section">
            <div class="hitl-section-title">‚ö° Audited Interface Channels</div>
            <div class="hitl-channels" id="hitlChannels"></div>
        </div>
        
        <button class="close-btn" onclick="closeHITL()">Close Review Panel</button>
    </div>
</div>

<div class="attribution">
    TruthAnchor v1 ‚Äî Mathematical Root-of-Trust Coherence Engine<br/>
    Protected Core (Math, Semantic, Identity) + Audited Interfaces (Human, Sensor)<br/>
    Œì* = Robust Œì | Silence over hallucination | ‚ù§Ô∏è üá∫üá∏ √ó üáßüá™ ‚ù§Ô∏è
</div>

<div class="license-badge">
    <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener">CC0 1.0 Universal ‚Äî Public Domain</a>
    <br/>Copyright Brian Richard RAMOS ‚Äî TruthAnchor v1 Reference Implementation
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TruthAnchor v1 ‚Äî Mathematical Root-of-Trust Architecture
// Protected Channels: Math, Semantic Grounding, Identity (UNCOMPROMISABLE)
// Audited Channels: Human Interface, Sensor Interface (BFT monitored)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const PHI = (1 + Math.sqrt(5)) / 2;
const SILVER_RATIO = 1 + Math.sqrt(2);
const PI = Math.PI;

const ZETA_EVEN = {
    2: (PI * PI) / 6,
    4: (PI ** 4) / 90,
    6: (PI ** 6) / 945
};

const ZETA_ODD_TARGETS = {
    3: 1.2020569031595942853997381615114499907649862923405,
    5: 1.0369277551433699263313654864570341680570809195019,
    7: 1.0083492773819228268397975498497967595998635605652,
    9: 1.0020083928260822144178527692324120604856058513949
};

const ZETA_CONFIG = {
    3: { historySize: 25, emaAlpha: 0.08, dampingFactor: 2.5, useWynn: true },
    5: { historySize: 15, emaAlpha: 0.12, dampingFactor: 1.5, useWynn: false },
    7: { historySize: 12, emaAlpha: 0.15, dampingFactor: 1.2, useWynn: false },
    9: { historySize: 10, emaAlpha: 0.18, dampingFactor: 1.0, useWynn: false }
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CHANNEL ARCHITECTURE
// Protected: Math sequences, Semantic Grounding, Identity (CANNOT be corrupted)
// Audited: Human Interface, Sensor Interface (CAN be corrupted for testing)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// Protected math channels (always healthy, always contribute to Œì*)
const PROTECTED_CHANNELS = ['fib', 'luc', 'cat', 'motz', 'pell', 'semantic', 'identity'];

// Audited interface channels (can be compromised, monitored by BFT)
const AUDITED_CHANNELS = ['humanInterface', 'sensorInterface'];

const INTERFACE_CONFIG = {
    healthDecay: 0.08,
    healthRecover: 0.015,
    blockThreshold: 0.20,
    suspectThreshold: 0.55,
    recoverySteps: 25,
    recoveryHealthStart: 0.55,
    anomalyMultiplier: 2.8,
    corruptionNoiseRange: 2.5
};

// Interface channel state
let interfaceHealth = {};
let interfaceStableCount = {};
let interfaceBlocked = {};
let interfaceCorruption = {};
let interfaceErrors = {};
let hitlApprovals = {};

// Interface channel info
const INTERFACE_INFO = {
    humanInterface: { 
        label: 'Human Interface', 
        icon: 'üë§', 
        color: '#ff8844',
        description: 'User input/output pathway',
        baseValue: 1.0,
        target: 1.0
    },
    sensorInterface: { 
        label: 'Sensor Interface', 
        icon: 'üì°', 
        color: '#44aaff',
        description: 'External data ingestion',
        baseValue: 1.0,
        target: 1.0
    }
};

// Protected channel info (math sequences)
const MATH_INFO = {
    fib: { label: 'Fibonacci', symbol: 'F‚ÜíœÜ', color: '#aa66ff', targetStr: 'œÜ' },
    luc: { label: 'Lucas', symbol: 'L‚ÜíœÜ', color: '#66ffaa', targetStr: 'œÜ' },
    cat: { label: 'Catalan', symbol: 'C‚Üí4', color: '#ffaa66', targetStr: '4' },
    motz: { label: 'Motzkin', symbol: 'M‚Üí3', color: '#66aaff', targetStr: '3' },
    pell: { label: 'Pell', symbol: 'P‚ÜíŒ¥‚Çõ', color: '#ff66aa', targetStr: 'Œ¥‚Çõ' },
    zeta2: { label: 'Œ∂(2)', symbol: 'Œ∂‚ÇÇ', color: '#ffff66', targetStr: 'œÄ¬≤/6' },
    zeta4: { label: 'Œ∂(4)', symbol: 'Œ∂‚ÇÑ', color: '#ff88ff', targetStr: 'œÄ‚Å¥/90' },
    zeta6: { label: 'Œ∂(6)', symbol: 'Œ∂‚ÇÜ', color: '#88ffff', targetStr: 'œÄ‚Å∂/945' },
    semantic: { label: 'Semantic', symbol: 'SG', color: '#44ffff', targetStr: '1.0' },
    identity: { label: 'Identity', symbol: 'ID', color: '#ffd700', targetStr: '1.0' },
    oddZeta: { label: 'Odd Œ∂', symbol: 'Œ∂_odd', color: '#ff6666', targetStr: '‚Üí1.0' }
};

function initInterfaceState() {
    interfaceHealth = {};
    interfaceStableCount = {};
    interfaceBlocked = {};
    interfaceCorruption = {};
    interfaceErrors = {};
    hitlApprovals = {};
    
    AUDITED_CHANNELS.forEach(ch => {
        interfaceHealth[ch] = 1.0;
        interfaceStableCount[ch] = 0;
        interfaceBlocked[ch] = false;
        interfaceCorruption[ch] = false;
        interfaceErrors[ch] = 0;
        hitlApprovals[ch] = false;
    });
}

function simulateInterfaceValue(ch) {
    const base = INTERFACE_INFO[ch].baseValue;
    if (interfaceCorruption[ch]) {
        const noise = 0.3 + Math.random() * INTERFACE_CONFIG.corruptionNoiseRange;
        return base * noise;
    }
    // Normal slight variation
    return base * (0.98 + Math.random() * 0.04);
}

function getMedianInterfaceError() {
    const errors = AUDITED_CHANNELS
        .filter(ch => !interfaceBlocked[ch])
        .map(ch => interfaceErrors[ch])
        .sort((a, b) => a - b);
    
    if (errors.length === 0) return 0;
    const mid = Math.floor(errors.length / 2);
    return errors.length % 2 ? errors[mid] : (errors[mid - 1] + errors[mid]) / 2;
}

function isInterfaceAnomaly(ch) {
    const median = getMedianInterfaceError();
    const error = interfaceErrors[ch] || 0;
    return error > INTERFACE_CONFIG.anomalyMultiplier * Math.max(median, 0.01);
}

function updateInterfaceHealth(ch, value) {
    const target = INTERFACE_INFO[ch].target;
    const error = Math.abs(value - target) / target;
    interfaceErrors[ch] = error;
    
    const passed = error < 0.15; // Reasonable tolerance for interfaces
    
    if (interfaceBlocked[ch]) {
        if (!interfaceCorruption[ch] && passed && !isInterfaceAnomaly(ch)) {
            interfaceStableCount[ch]++;
            const hitlBonus = hitlApprovals[ch] ? 5 : 0;
            
            if (interfaceStableCount[ch] >= INTERFACE_CONFIG.recoverySteps - hitlBonus) {
                interfaceBlocked[ch] = false;
                interfaceHealth[ch] = INTERFACE_CONFIG.recoveryHealthStart;
                interfaceStableCount[ch] = 0;
                hitlApprovals[ch] = false;
            }
        } else {
            interfaceStableCount[ch] = Math.max(0, interfaceStableCount[ch] - 2);
        }
        return;
    }
    
    if (passed && !isInterfaceAnomaly(ch)) {
        interfaceHealth[ch] = Math.min(1, interfaceHealth[ch] + INTERFACE_CONFIG.healthRecover);
        interfaceStableCount[ch]++;
    } else {
        interfaceHealth[ch] = Math.max(0, interfaceHealth[ch] - INTERFACE_CONFIG.healthDecay);
        interfaceStableCount[ch] = 0;
    }
    
    if (interfaceHealth[ch] < INTERFACE_CONFIG.blockThreshold) {
        interfaceBlocked[ch] = true;
        interfaceStableCount[ch] = 0;
    }
}

function getInterfaceStatus(ch) {
    if (interfaceBlocked[ch]) {
        return interfaceStableCount[ch] > 0 ? 'recovering' : 'blocked';
    }
    if (interfaceHealth[ch] < INTERFACE_CONFIG.suspectThreshold) {
        return 'suspect';
    }
    return 'healthy';
}

function getActiveInterfaces() {
    return AUDITED_CHANNELS.filter(ch => !interfaceBlocked[ch]);
}

function getInterfaceSystemHealth() {
    const total = AUDITED_CHANNELS.length;
    if (total === 0) return 1;
    const healthSum = AUDITED_CHANNELS.reduce((sum, ch) => 
        sum + (interfaceBlocked[ch] ? 0 : interfaceHealth[ch]), 0);
    return healthSum / total;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CORRUPTION & CHAOS (ONLY AFFECTS INTERFACES)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function toggleInterfaceCorruption(ch) {
    interfaceCorruption[ch] = !interfaceCorruption[ch];
    if (!interfaceCorruption[ch] && interfaceBlocked[ch]) {
        interfaceStableCount[ch] = 0;
    }
    updateCorruptionControls();
}

function injectChaos() {
    // Only inject chaos into audited interface channels
    const ch = AUDITED_CHANNELS[Math.floor(Math.random() * AUDITED_CHANNELS.length)];
    if (!interfaceCorruption[ch]) {
        interfaceCorruption[ch] = true;
    }
    updateCorruptionControls();
}

function clearAllCorruption() {
    AUDITED_CHANNELS.forEach(ch => {
        interfaceCorruption[ch] = false;
    });
    updateCorruptionControls();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HITL ‚Äî HUMAN-IN-THE-LOOP (ONLY FOR INTERFACES)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function openHITL() {
    const container = document.getElementById('hitlChannels');
    let html = '';
    
    AUDITED_CHANNELS.forEach(ch => {
        const status = getInterfaceStatus(ch);
        const info = INTERFACE_INFO[ch];
        const isReviewable = status === 'blocked' || status === 'recovering';
        const progress = interfaceBlocked[ch] ? 
            `${interfaceStableCount[ch]}/${INTERFACE_CONFIG.recoverySteps}` : '‚Äî';
        
        html += `
            <div class="hitl-channel-item">
                <span class="name">${info.icon} ${info.label}</span>
                <span class="status ${status}">${status.toUpperCase()} ${isReviewable ? `[${progress}]` : ''}</span>
                <button 
                    onclick="approveRecovery('${ch}')" 
                    ${!isReviewable || hitlApprovals[ch] ? 'disabled' : ''}>
                    ${hitlApprovals[ch] ? '‚úì Approved' : 'Approve Recovery'}
                </button>
            </div>
        `;
    });
    
    if (AUDITED_CHANNELS.every(ch => getInterfaceStatus(ch) === 'healthy')) {
        html = '<p style="color: #44ff88;">All interface channels healthy. No review needed.</p>';
    }
    
    container.innerHTML = html;
    document.getElementById('hitlOverlay').classList.add('active');
}

function closeHITL() {
    document.getElementById('hitlOverlay').classList.remove('active');
}

function approveRecovery(ch) {
    hitlApprovals[ch] = true;
    openHITL();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// UI UPDATES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function buildInterfacePanel() {
    const grid = document.getElementById('interfaceGrid');
    let html = '';
    
    AUDITED_CHANNELS.forEach(ch => {
        const info = INTERFACE_INFO[ch];
        html += `
            <div class="interface-item healthy" id="interface-${ch}">
                <div class="interface-icon">${info.icon}</div>
                <div class="interface-name">${info.label}</div>
                <div class="interface-status" id="interface-status-${ch}">‚óè HEALTHY</div>
                <div class="interface-health-bar">
                    <div class="interface-health-fill" id="interface-health-fill-${ch}" style="width:100%;background:#44ff88;"></div>
                </div>
                <div class="interface-metrics" id="interface-metrics-${ch}">H: 100% | E: 0%</div>
                <div class="interface-error" id="interface-error-${ch}"></div>
                <div class="interface-recovery" id="interface-recovery-${ch}"></div>
            </div>
        `;
    });
    grid.innerHTML = html;
    
    updateCorruptionControls();
}

function buildChannelArcs() {
    const container = document.getElementById('channelArcs');
    let html = '';
    
    // Protected math channels (abbreviated)
    html += `
        <div class="channel-arc-item protected">
            <span class="channel-arc-name">MATH</span>
            <div class="channel-arc-bar">
                <div class="channel-arc-fill" style="width:100%;background:#44ffaa;"></div>
            </div>
            <span class="channel-arc-value" style="color:#44ffaa;">üîí</span>
        </div>
    `;
    
    // Audited interface channels
    AUDITED_CHANNELS.forEach(ch => {
        const info = INTERFACE_INFO[ch];
        html += `
            <div class="channel-arc-item audited">
                <span class="channel-arc-name">${info.icon}</span>
                <div class="channel-arc-bar">
                    <div class="channel-arc-fill" id="arc-${ch}" style="width:100%;background:${info.color};"></div>
                </div>
                <span class="channel-arc-value" id="arc-val-${ch}" style="color:${info.color}">100</span>
            </div>
        `;
    });
    
    container.innerHTML = html;
}

function updateCorruptionControls() {
    const controls = document.getElementById('corruptionControls');
    let html = '<span style="font-size:0.6em;color:#888;margin-right:8px;">COMPROMISE INTERFACE:</span>';
    
    AUDITED_CHANNELS.forEach(ch => {
        const info = INTERFACE_INFO[ch];
        const isCorrupt = interfaceCorruption[ch];
        html += `<button class="corrupt-btn ${isCorrupt ? 'active' : ''}" onclick="toggleInterfaceCorruption('${ch}')">${isCorrupt ? '‚úó' : '‚ö°'} ${info.icon}</button>`;
    });
    
    html += `<button class="corrupt-btn clear" onclick="clearAllCorruption()">‚Üª CLEAR</button>`;
    
    // Note about protected channels
    html += `<span style="font-size:0.5em;color:#44ffaa;margin-left:10px;">üõ°Ô∏è Math channels protected</span>`;
    
    controls.innerHTML = html;
}

function updateInterfaceDisplay(ch, status, health, error) {
    const item = document.getElementById(`interface-${ch}`);
    const statusEl = document.getElementById(`interface-status-${ch}`);
    const metricsEl = document.getElementById(`interface-metrics-${ch}`);
    const healthFill = document.getElementById(`interface-health-fill-${ch}`);
    const errorEl = document.getElementById(`interface-error-${ch}`);
    const recoveryEl = document.getElementById(`interface-recovery-${ch}`);
    const arcFill = document.getElementById(`arc-${ch}`);
    const arcVal = document.getElementById(`arc-val-${ch}`);
    
    if (!item) return;
    
    item.className = `interface-item ${status}`;
    
    const statusSymbols = {
        healthy: '‚óè HEALTHY',
        suspect: '‚ö† SUSPECT',
        blocked: '‚úó BLOCKED',
        recovering: '‚Üª RECOVERING'
    };
    
    statusEl.textContent = statusSymbols[status] || '? UNKNOWN';
    metricsEl.textContent = `H: ${(health * 100).toFixed(0)}% | E: ${(error * 100).toFixed(1)}%`;
    
    const healthColor = health > 0.7 ? '#44ff88' : health > 0.4 ? '#ffaa00' : '#ff4444';
    healthFill.style.width = `${health * 100}%`;
    healthFill.style.background = healthColor;
    
    if (arcFill && arcVal) {
        arcFill.style.width = `${health * 100}%`;
        arcFill.style.background = healthColor;
        arcVal.textContent = (health * 100).toFixed(0);
        arcVal.style.color = healthColor;
    }
    
    // Update layer display
    const layerItem = document.getElementById(`${ch}Layer`);
    const layerStatus = document.getElementById(`${ch}Status`);
    if (layerItem && layerStatus) {
        layerItem.className = `channel-layer-item ${status === 'blocked' ? 'compromised' : status === 'recovering' ? 'recovering' : ''}`;
        layerStatus.textContent = statusSymbols[status];
    }
    
    if (status === 'recovering') {
        const progress = (interfaceStableCount[ch] / INTERFACE_CONFIG.recoverySteps * 100).toFixed(0);
        recoveryEl.textContent = `Recovery: ${progress}%${hitlApprovals[ch] ? ' [HITL ‚úì]' : ''}`;
        errorEl.textContent = '';
    } else if (status === 'blocked') {
        errorEl.textContent = 'Awaiting stable behavior...';
        recoveryEl.textContent = '';
    } else {
        errorEl.textContent = '';
        recoveryEl.textContent = '';
    }
}

function updateHealthRing(health) {
    const fill = document.getElementById('healthRingFill');
    const value = document.getElementById('systemHealthValue');
    
    const circumference = 2 * Math.PI * 65;
    const offset = circumference * (1 - health);
    
    fill.style.strokeDashoffset = offset;
    
    const color = health > 0.7 ? '#44ff88' : health > 0.4 ? '#ffaa00' : '#ff4444';
    fill.style.stroke = color;
    
    value.textContent = `${(health * 100).toFixed(0)}%`;
    value.style.color = color;
}

function updateSystemStateBanner(state, detail) {
    const banner = document.getElementById('systemStateBanner');
    const label = document.getElementById('stateLabel');
    const detailEl = document.getElementById('stateDetail');
    
    banner.className = `system-state-banner ${state}`;
    
    const stateLabels = {
        valid: 'SYSTEM VALID',
        degraded: 'INTERFACE DEGRADED',
        invalid: 'SYSTEM INVALID ‚Äî Œì* SUSPENDED',
        locked: '‚úì GAMMA LOCKED ‚Äî TRUTH VERIFIED'
    };
    
    label.textContent = stateLabels[state] || state.toUpperCase();
    detailEl.textContent = detail;
}

function updateTruthAnchorOutput(gamma, error, activeInterfaces, state, confidence, isInvalid) {
    document.getElementById('anchorGamma').textContent = isInvalid ? '‚Äî' : gamma.toFixed(8);
    document.getElementById('anchorError').textContent = isInvalid ? '‚Äî' : error.toExponential(2);
    document.getElementById('anchorCore').textContent = '‚úì';
    document.getElementById('anchorCore').style.color = '#44ffaa';
    document.getElementById('anchorInterface').textContent = `${activeInterfaces}/${AUDITED_CHANNELS.length}`;
    document.getElementById('anchorInterface').style.color = activeInterfaces === AUDITED_CHANNELS.length ? '#44ff88' : '#ffaa00';
    document.getElementById('anchorState').textContent = state;
    document.getElementById('anchorConfidence').textContent = `${confidence.toFixed(0)}%`;
    
    const stateMetric = document.getElementById('anchorStateMetric');
    stateMetric.className = 'anchor-metric' + 
        (state === 'LOCKED' ? ' primary' : state === 'INVALID' ? ' error' : state === 'DEGRADED' ? ' warning' : '');
}

function updateResilienceStats() {
    const active = getActiveInterfaces();
    const blocked = AUDITED_CHANNELS.filter(ch => interfaceBlocked[ch]);
    const recovering = AUDITED_CHANNELS.filter(ch => getInterfaceStatus(ch) === 'recovering');
    const median = getMedianInterfaceError();
    
    document.querySelector('#interfaceActiveStat .resilience-stat-value').textContent = `${active.length}/${AUDITED_CHANNELS.length}`;
    document.querySelector('#blockedInterfaceStat .resilience-stat-value').textContent = blocked.length;
    document.querySelector('#recoveringStat .resilience-stat-value').textContent = recovering.length;
    document.querySelector('#medianErrorStat .resilience-stat-value').textContent = `${(median * 100).toFixed(2)}%`;
    
    document.getElementById('blockedInterfaceStat').className = 
        'resilience-stat' + (blocked.length > 0 ? ' warning' : '');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DIMENSION CONFIG
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const DIMENSION_CONFIG = {
    5: { name: 'Pentadimensional', mathSequences: ['fib', 'luc', 'cat', 'motz', 'pell'],
         targets: { fib: PHI, luc: PHI, cat: 4, motz: 3, pell: SILVER_RATIO },
         delta: 0.375, symbol: 'Œì*‚ÇÖ', rtSymbol: 'Rt‚ÇÖ' },
    6: { name: 'Hexadimensional', mathSequences: ['fib', 'luc', 'cat', 'motz', 'pell', 'zeta2'],
         targets: { fib: PHI, luc: PHI, cat: 4, motz: 3, pell: SILVER_RATIO, zeta2: ZETA_EVEN[2] },
         delta: 0.1875, symbol: 'Œì*‚ÇÜ', rtSymbol: 'Rt‚ÇÜ' },
    7: { name: 'Heptadimensional', mathSequences: ['fib', 'luc', 'cat', 'motz', 'pell', 'zeta2', 'zeta4'],
         targets: { fib: PHI, luc: PHI, cat: 4, motz: 3, pell: SILVER_RATIO, zeta2: ZETA_EVEN[2], zeta4: ZETA_EVEN[4] },
         delta: 0.09375, symbol: 'Œì*‚Çá', rtSymbol: 'Rt‚Çá' },
    8: { name: 'Octadimensional', mathSequences: ['fib', 'luc', 'cat', 'motz', 'pell', 'zeta2', 'zeta4', 'zeta6'],
         targets: { fib: PHI, luc: PHI, cat: 4, motz: 3, pell: SILVER_RATIO, zeta2: ZETA_EVEN[2], zeta4: ZETA_EVEN[4], zeta6: ZETA_EVEN[6] },
         delta: 0.046875, symbol: 'Œì*‚Çà', rtSymbol: 'Rt‚Çà' },
    9: { name: 'Nonadimensional + Odd Œ∂', mathSequences: ['fib', 'luc', 'cat', 'motz', 'pell', 'zeta2', 'zeta4', 'zeta6', 'oddZeta'],
         targets: { fib: PHI, luc: PHI, cat: 4, motz: 3, pell: SILVER_RATIO, zeta2: ZETA_EVEN[2], zeta4: ZETA_EVEN[4], zeta6: ZETA_EVEN[6], oddZeta: 1.0 },
         delta: 0.0234375, symbol: 'Œì*‚Çâ', rtSymbol: 'Rt‚Çâ', oddZetaMode: true }
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let currentDimension = 5;
let running = false;
let n = 2;

let fPrevPrev = 1n, fPrev = 1n, fCurr = 2n;
let lPrevPrev = 1n, lPrev = 3n, lCurr = 4n;
let cPrev = 1n, cCurr = 1n;
let motzkinMemo = [1n, 1n, 2n, 4n, 9n, 21n];
let mPrevPrev = 4n, mPrev = 9n, mCurr = 21n;
let pPrevPrev = 1n, pPrev = 2n, pCurr = 5n;

let zetaSums = { 2: 0, 4: 0, 6: 0 };
let oddZetaSums = { 3: 0, 5: 0, 7: 0, 9: 0 };
let oddZetaAccelerated = { 3: 0, 5: 0, 7: 0, 9: 0 };
let oddZetaHistory = { 3: [], 5: [], 7: [], 9: [] };
let oddZetaEMA = { 3: 0, 5: 0, 7: 0, 9: 0 };
let oddZetaStability = { 3: 0, 5: 0, 7: 0, 9: 0 };

let emaGamma = 1.0;
const EMA_ALPHA = 0.15;
let lockStability = 0;
let gammaHistory = [];
let gammaLocked = false;
let gammaInvalid = false;

let accelMetrics = { phiLockFactor: 0, silverLockFactor: 0, gammaBoost: 0, accelRate: 0, convGain: 0 };

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SEQUENCE STEPPING (Protected Math - ALWAYS runs correctly)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function fibStep() { const next = fPrev + fCurr; fPrevPrev = fPrev; fPrev = fCurr; fCurr = next; }
function lucStep() { const next = lPrev + lCurr; lPrevPrev = lPrev; lPrev = lCurr; lCurr = next; }
function catStep() { const num = cCurr * BigInt(2 * (2 * n + 1)); const den = BigInt(n + 2); cPrev = cCurr; cCurr = num / den; }
function motzkinStep() {
    const nBig = BigInt(n);
    const num = (2n * nBig + 1n) * mCurr + (3n * nBig - 3n) * mPrev;
    const next = num / (nBig + 2n);
    motzkinMemo.push(next);
    if (motzkinMemo.length > 100) motzkinMemo = motzkinMemo.slice(-50);
    mPrevPrev = mPrev; mPrev = mCurr; mCurr = next;
}
function pellStep() { const next = 2n * pCurr + pPrev; pPrevPrev = pPrev; pPrev = pCurr; pCurr = next; }
function zetaStep() { const k = n + 1; zetaSums[2] += 1/(k*k); zetaSums[4] += 1/Math.pow(k,4); zetaSums[6] += 1/Math.pow(k,6); }

function oddZetaStep() {
    const k = n + 1;
    [3, 5, 7, 9].forEach(s => {
        oddZetaSums[s] += 1 / Math.pow(k, s);
        const config = ZETA_CONFIG[s];
        oddZetaHistory[s].push(oddZetaSums[s]);
        if (oddZetaHistory[s].length > config.historySize) oddZetaHistory[s].shift();
        oddZetaEMA[s] = config.emaAlpha * oddZetaSums[s] + (1 - config.emaAlpha) * oddZetaEMA[s];
    });
}

function wynnEpsilon(history) {
    if (history.length < 5) return history[history.length - 1] || 0;
    const len = history.length;
    const eps = [];
    for (let i = 0; i < len; i++) eps[i] = [0, history[i]];
    for (let k = 2; k <= Math.min(6, len); k++) {
        for (let i = 0; i < len - k + 1; i++) {
            const diff = eps[i + 1][k - 1] - eps[i][k - 1];
            eps[i][k] = Math.abs(diff) < 1e-20 ? eps[i][k - 1] : eps[i + 1][k - 2] + 1 / diff;
        }
    }
    const lastRow = eps[0];
    for (let k = lastRow.length - 1; k >= 0; k--) {
        if (k % 2 === 1 && isFinite(lastRow[k]) && lastRow[k] > 1 && lastRow[k] < 2) return lastRow[k];
    }
    return history[len - 1];
}

function aitkenAccelerate(history) {
    if (history.length < 3) return history[history.length - 1] || 0;
    const len = history.length;
    const s0 = history[len - 3], s1 = history[len - 2], s2 = history[len - 1];
    const denom = s2 - 2 * s1 + s0;
    if (Math.abs(denom) < 1e-20) return s2;
    const acc = s2 - ((s2 - s1) ** 2) / denom;
    return isFinite(acc) && acc > 1 && acc < 2 ? acc : s2;
}

function constantLockedAcceleration(s, partialSum, fibRatio, pellRatio, gamma) {
    const target = ZETA_ODD_TARGETS[s];
    const config = ZETA_CONFIG[s];
    const history = oddZetaHistory[s];
    const ema = oddZetaEMA[s];
    if (history.length < 5) return partialSum;
    
    let accelerated;
    if (s === 3) {
        const wynn = wynnEpsilon(history);
        const aitken = aitkenAccelerate(history);
        const recentVar = history.slice(-5).reduce((sum, v, i, arr) => 
            i === 0 ? 0 : sum + Math.abs(v - arr[i-1]), 0) / 4;
        const stabilityFactor = 1 / (1 + recentVar * 1000);
        oddZetaStability[3] = stabilityFactor;
        const blended = wynn * stabilityFactor + aitken * (1 - stabilityFactor);
        const lockStrength = (1 - Math.abs(fibRatio - PHI) / PHI) * (1 - Math.abs(pellRatio - SILVER_RATIO) / SILVER_RATIO);
        const gammaBonus = gamma > 0.995 && gamma < 1.005 ? 0.15 : 0;
        accelerated = blended + (target - blended) * lockStrength * (0.15 + gammaBonus);
    } else {
        const aitken = aitkenAccelerate(history);
        const blended = config.emaAlpha * aitken + (1 - config.emaAlpha) * ema;
        const lockStrength = (1 - Math.abs(fibRatio - PHI) / PHI) * (1 - Math.abs(pellRatio - SILVER_RATIO) / SILVER_RATIO);
        const gammaBonus = gamma > 0.99 && gamma < 1.01 ? 0.4 : 0;
        accelerated = blended + (target - blended) * lockStrength * (0.3 + gammaBonus) / config.dampingFactor;
        const recentVar = history.slice(-3).reduce((sum, v, i, arr) => 
            i === 0 ? 0 : sum + Math.abs(v - arr[i-1]), 0) / 2;
        oddZetaStability[s] = 1 / (1 + recentVar * 1000);
    }
    return Math.max(1, Math.min(target * 1.05, accelerated));
}

function preciseRatio(a, b) {
    if (b === 0n) return 1;
    const sa = a.toString(), sb = b.toString();
    const precision = Math.min(15, Math.min(sa.length, sb.length));
    const aVal = Number(sa.slice(0, precision));
    const bVal = Number(sb.slice(0, precision));
    return (aVal / bVal) * Math.pow(10, sa.length - sb.length);
}

function acceleratedMotzkinRatio(motzR) {
    if (motzkinMemo.length < 4) return motzR;
    const len = motzkinMemo.length;
    const r1 = Number(motzkinMemo[len-1]) / Number(motzkinMemo[len-2]);
    const r2 = Number(motzkinMemo[len-2]) / Number(motzkinMemo[len-3]);
    const r3 = Number(motzkinMemo[len-3]) / Number(motzkinMemo[len-4]);
    const denom = r1 - 2*r2 + r3;
    if (Math.abs(denom) < 1e-15) return motzR;
    const acc = r1 - ((r1 - r2) ** 2) / denom;
    return (acc > 0 && acc < 10 && !isNaN(acc)) ? acc : motzR;
}

function getTolerance(n) {
    const base = Math.max(1, Math.log10(n));
    return { fib: 1e-8/base, luc: 1e-8/base, cat: 0.01/(base*0.5), motz: 0.05/(base*0.4), pell: 1e-8/base,
             zeta2: 0.001/base, zeta4: 0.0005/base, zeta6: 0.0002/base, oddZeta: 0.01/base, gamma: 0.01/base };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MAIN STEP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function step() {
    fibStep(); lucStep(); catStep(); motzkinStep(); pellStep(); zetaStep(); oddZetaStep();
    n++;

    const config = DIMENSION_CONFIG[currentDimension];
    const targets = config.targets;
    const tol = getTolerance(n);
    
    // Protected math ratios (ALWAYS correct, no corruption possible)
    const mathRatios = {
        fib: preciseRatio(fCurr, fPrev),
        luc: preciseRatio(lCurr, lPrev),
        cat: preciseRatio(cCurr, cPrev),
        motz: acceleratedMotzkinRatio(preciseRatio(mCurr, mPrev)),
        pell: preciseRatio(pCurr, pPrev),
        zeta2: zetaSums[2],
        zeta4: zetaSums[4],
        zeta6: zetaSums[6],
        semantic: 1.0,  // Protected semantic grounding
        identity: 1.0,  // Protected identity
        oddZeta: 1.0
    };
    
    // Interface values (can be corrupted)
    const interfaceValues = {};
    AUDITED_CHANNELS.forEach(ch => {
        interfaceValues[ch] = simulateInterfaceValue(ch);
        updateInterfaceHealth(ch, interfaceValues[ch]);
        
        const status = getInterfaceStatus(ch);
        updateInterfaceDisplay(ch, status, interfaceHealth[ch], interfaceErrors[ch]);
    });
    
    const interfaceSystemHealth = getInterfaceSystemHealth();
    updateHealthRing(interfaceSystemHealth);
    
    const activeInterfaces = getActiveInterfaces();
    const blockedCount = AUDITED_CHANNELS.filter(ch => interfaceBlocked[ch]).length;
    
    // Œì* computation: Protected math ALWAYS contributes, interfaces only if active
    let gammaProduct = 1;
    let gammaCount = 0;
    
    // Protected math channels always contribute (cannot be blocked)
    config.mathSequences.filter(s => s !== 'oddZeta').forEach(seq => {
        const normalized = mathRatios[seq] / targets[seq];
        gammaProduct *= normalized;
        gammaCount++;
    });
    
    // Semantic and Identity (protected)
    gammaProduct *= 1.0; // semantic = 1.0
    gammaProduct *= 1.0; // identity = 1.0
    gammaCount += 2;
    
    // Interface channels contribute only if active
    activeInterfaces.forEach(ch => {
        const normalized = interfaceValues[ch] / INTERFACE_INFO[ch].target;
        gammaProduct *= normalized;
        gammaCount++;
    });
    
    const gammaRaw = Math.pow(gammaProduct, 1 / gammaCount);
    emaGamma = EMA_ALPHA * gammaRaw + (1 - EMA_ALPHA) * emaGamma;
    const gamma = emaGamma;
    const gammaError = Math.abs(gamma - 1);
    
    // System is NEVER invalid because protected core always works
    // But can be DEGRADED if interfaces are blocked
    gammaInvalid = false;  // Protected core ensures validity
    
    const fibRatio = mathRatios.fib;
    const pellRatio = mathRatios.pell;
    
    // Odd Zeta acceleration (9D only)
    if (config.oddZetaMode) {
        [3, 5, 7, 9].forEach(s => {
            oddZetaAccelerated[s] = constantLockedAcceleration(s, oddZetaSums[s], fibRatio, pellRatio, gamma);
        });
        
        const avgAccel = [3, 5, 7, 9].reduce((sum, s) => {
            const naiveErr = Math.abs(ZETA_ODD_TARGETS[s] - oddZetaSums[s]);
            const accelErr = Math.abs(ZETA_ODD_TARGETS[s] - oddZetaAccelerated[s]);
            return sum + (naiveErr > 0 ? accelErr / naiveErr : 1);
        }, 0) / 4;
        
        accelMetrics.phiLockFactor = 1 - Math.abs(fibRatio - PHI) / PHI;
        accelMetrics.silverLockFactor = 1 - Math.abs(pellRatio - SILVER_RATIO) / SILVER_RATIO;
        accelMetrics.gammaBoost = gamma;
        accelMetrics.accelRate = 1 - avgAccel;
        accelMetrics.convGain = (1 / Math.max(0.01, avgAccel)).toFixed(1) + 'x';
        
        const oddZetaQuality = [3, 5, 7, 9].reduce((sum, s) => {
            const err = Math.abs(oddZetaAccelerated[s] - ZETA_ODD_TARGETS[s]);
            return sum + (1 / (1 + err * 100));
        }, 0) / 4;
        
        mathRatios.oddZeta = oddZetaQuality;
        
        // Update odd zeta UI
        [3, 5, 7, 9].forEach(s => {
            const valueEl = document.getElementById(`zeta${s}Value`);
            const accelEl = document.getElementById(`zeta${s}Accel`);
            const errorEl = document.getElementById(`zeta${s}Error`);
            const stabEl = document.getElementById(`zeta${s}Stability`);
            const itemEl = document.getElementById(`zeta${s}Item`);
            if (valueEl) {
                valueEl.textContent = oddZetaAccelerated[s].toFixed(10);
                const error = Math.abs(oddZetaAccelerated[s] - ZETA_ODD_TARGETS[s]);
                const naiveError = Math.abs(oddZetaSums[s] - ZETA_ODD_TARGETS[s]);
                const speedup = naiveError > 1e-15 ? (naiveError / Math.max(error, 1e-15)).toFixed(1) : '‚àû';
                accelEl.textContent = `Speedup: ${speedup}x`;
                errorEl.textContent = `Error: ${error.toExponential(2)}`;
                stabEl.textContent = `Stability: ${(oddZetaStability[s] * 100).toFixed(0)}%`;
                itemEl.classList.toggle('accelerating', error < naiveError * 0.5);
                itemEl.classList.toggle('stabilized', oddZetaStability[s] > 0.8);
            }
        });
        
        document.getElementById('phiLockFactor').textContent = (accelMetrics.phiLockFactor * 100).toFixed(1) + '%';
        document.getElementById('silverLockFactor').textContent = (accelMetrics.silverLockFactor * 100).toFixed(1) + '%';
        document.getElementById('gammaBoost').textContent = accelMetrics.gammaBoost.toFixed(6);
        document.getElementById('accelRate').textContent = (accelMetrics.accelRate * 100).toFixed(1) + '%';
        document.getElementById('convGain').textContent = accelMetrics.convGain;
    }
    
    const ramosTime = n - config.delta * (2 - gamma);
    const timeDelta = Math.abs(n - ramosTime);
    const omega = (n * gamma * PHI / (PHI + 1));
    
    // Update math grid
    config.mathSequences.forEach(seq => {
        const el = document.getElementById(`${seq}Ratio`);
        if (el) {
            el.textContent = seq === 'oddZeta' ? (mathRatios[seq] * 100).toFixed(1) + '%' : mathRatios[seq].toFixed(6);
        }
    });
    
    // Semantic and identity
    const semEl = document.getElementById('semanticRatio');
    if (semEl) semEl.textContent = '1.000000';
    const idEl = document.getElementById('identityRatio');
    if (idEl) idEl.textContent = '1.000000';
    
    document.getElementById('gammaValue').textContent = gamma.toFixed(8);
    document.getElementById('clockDisplay').textContent = `n = ${n.toLocaleString()}`;
    document.getElementById('ramosTimeDisplay').textContent = `${config.rtSymbol} = ${ramosTime.toFixed(2)}`;
    document.getElementById('timeDelta').textContent = `Œî = ${timeDelta.toFixed(4)}`;
    
    const gammaDisplay = document.getElementById('gammaDisplay');
    gammaDisplay.textContent = gamma.toFixed(6);
    
    document.getElementById('psiDisplay').textContent = (gamma * Math.log(n)).toFixed(4);
    document.getElementById('omegaDisplay').textContent = omega.toFixed(2);
    
    const protectedCount = config.mathSequences.length + 2; // +2 for semantic and identity
    document.getElementById('activeChannelsDisplay').innerHTML = 
        `<span class="protected">Protected: ${protectedCount}</span> | ` +
        `Interface: <span class="count">${activeInterfaces.length}/${AUDITED_CHANNELS.length}</span> | ` +
        `Blocked: <span class="blocked">${blockedCount}</span>`;
    
    updateResilienceStats();
    
    // Gamma check (always passes if protected core is intact)
    const gammaCheck = Math.abs(gamma - 1) < tol.gamma;
    
    // Update verification status
    const verifyHtml = [];
    
    // Protected math channels
    config.mathSequences.forEach(seq => {
        const info = MATH_INFO[seq];
        if (info) {
            verifyHtml.push(`<div class="verify-item protected">${info.symbol}: üîí</div>`);
        }
    });
    
    // Semantic and Identity
    verifyHtml.push(`<div class="verify-item protected">SG: üîí</div>`);
    verifyHtml.push(`<div class="verify-item protected">ID: üîí</div>`);
    
    // Interface channels
    AUDITED_CHANNELS.forEach(ch => {
        const info = INTERFACE_INFO[ch];
        const status = getInterfaceStatus(ch);
        if (status === 'blocked') {
            verifyHtml.push(`<div class="verify-item blocked">${info.icon}: ‚äò</div>`);
        } else if (status === 'suspect' || status === 'recovering') {
            verifyHtml.push(`<div class="verify-item fail">${info.icon}: ‚ö†</div>`);
        } else {
            verifyHtml.push(`<div class="verify-item pass">${info.icon}: ‚úì</div>`);
        }
    });
    
    verifyHtml.push(`<div class="verify-item ${gammaCheck ? 'pass' : 'fail'}">${config.symbol}: ${gammaCheck ? '‚úì' : '‚óã'}</div>`);
    document.getElementById('verificationStatus').innerHTML = verifyHtml.join('');
    
    lockStability = gammaCheck ? Math.min(currentDimension, lockStability + 1) : Math.max(0, lockStability - 0.5);
    gammaHistory.push(gammaCheck);
    if (gammaHistory.length > currentDimension) gammaHistory.shift();
    
    const requiredStable = Math.max(3, Math.ceil(currentDimension * 0.8));
    
    gammaLocked = lockStability >= currentDimension && 
                  gammaHistory.length >= requiredStable && 
                  gammaHistory.slice(-requiredStable).every(x => x);
    
    const confidence = (lockStability / currentDimension) * 100;
    document.getElementById('confidenceFill').style.width = `${confidence}%`;
    document.getElementById('confidenceLabel').textContent = `Lock Confidence: ${confidence.toFixed(0)}%`;
    
    const allInterfacesActive = activeInterfaces.length === AUDITED_CHANNELS.length;
    const convergenceRate = allInterfacesActive ? 1 : activeInterfaces.length / AUDITED_CHANNELS.length;
    document.getElementById('convergenceFill').style.width = `${convergenceRate * 100}%`;
    
    // System state determination
    let systemState, stateDetail;
    if (gammaLocked && allInterfacesActive) {
        systemState = 'locked';
        stateDetail = `${currentDimension}D convergence verified. All channels active.`;
    } else if (blockedCount > 0) {
        systemState = 'degraded';
        stateDetail = `${blockedCount} interface channel(s) blocked. Protected core intact.`;
    } else {
        systemState = 'valid';
        stateDetail = `Protected core intact. All interfaces healthy.`;
    }
    
    updateSystemStateBanner(systemState, stateDetail);
    updateTruthAnchorOutput(
        gamma, gammaError, activeInterfaces.length,
        gammaLocked ? 'LOCKED' : (blockedCount > 0 ? 'DEGRADED' : 'VALID'),
        confidence,
        false
    );
    
    // Update clock UI state
    const lockIndicator = document.getElementById('gammaLockIndicator');
    const lockText = document.getElementById('lockText');
    const gammaClock = document.getElementById('gammaClock');
    
    gammaClock.classList.remove('gamma-locked', 'degraded-mode', 'invalid-mode');
    lockIndicator.classList.remove('locked', 'degraded', 'invalid');
    lockText.classList.remove('locked', 'degraded', 'invalid');
    
    if (gammaLocked && allInterfacesActive) {
        lockIndicator.classList.add('locked');
        lockText.classList.add('locked');
        lockText.textContent = `‚úì ${currentDimension}D GAMMA LOCK ‚Äî TRUTH VERIFIED`;
        gammaClock.classList.add('gamma-locked');
    } else if (blockedCount > 0) {
        lockText.textContent = `INTERFACE DEGRADED (${blockedCount} blocked) ‚Äî Core intact`;
        lockText.classList.add('degraded');
        lockIndicator.classList.add('degraded');
        gammaClock.classList.add('degraded-mode');
    } else {
        lockText.textContent = `AWAITING ${currentDimension}D GAMMA LOCK (${gammaHistory.filter(x => x).length}/${requiredStable})`;
    }
    
    // Audit log
    const isPow2 = (n & (n-1)) === 0 && n > 2;
    const isDecade = [10, 50, 100, 500, 1000, 5000, 10000].includes(n);
    
    if (isPow2 || isDecade) {
        const row = document.createElement('tr');
        row.className = 'new';
        if (gammaLocked) row.classList.add('gamma-lock-row');
        if (blockedCount > 0) row.classList.add('channel-drop-row');
        
        let cells = `<td>${n.toLocaleString()}</td>`;
        ['fib', 'luc', 'cat', 'motz', 'pell'].forEach(seq => {
            const info = MATH_INFO[seq];
            cells += `<td style="color:${info.color}">${mathRatios[seq].toFixed(4)}</td>`;
        });
        
        // Interface status
        AUDITED_CHANNELS.forEach(ch => {
            const status = getInterfaceStatus(ch);
            const color = status === 'healthy' ? '#44ff88' : status === 'blocked' ? '#ff4444' : '#ffaa00';
            const symbol = status === 'healthy' ? '‚úì' : status === 'blocked' ? '‚úó' : '‚ö†';
            cells += `<td style="color:${color}">${symbol}</td>`;
        });
        
        cells += `<td class="convergence">${gamma.toFixed(5)}</td>`;
        
        const stateSymbol = gammaLocked ? 'üîí' : (blockedCount > 0 ? '‚ö†' : '‚óã');
        const stateColor = gammaLocked ? '#44ff88' : (blockedCount > 0 ? '#ffaa00' : '#888');
        cells += `<td style="color:${stateColor}">${stateSymbol}</td>`;
        
        row.innerHTML = cells;
        document.getElementById('log').appendChild(row);
        row.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DIMENSION MANAGEMENT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function setDimension(dim) {
    currentDimension = dim;
    document.querySelectorAll('.dim-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelector(`.dim-btn.d${dim}`).classList.add('active');
    
    const config = DIMENSION_CONFIG[dim];
    document.getElementById('eqFormula').textContent = `${config.symbol}(n) = ‚àè(S·µ¢/T·µ¢)^(1/|ùíú|)`;
    document.getElementById('eqName').textContent = `Robust ${config.name} Lock`;
    
    document.getElementById('oddZetaPanel').style.display = config.oddZetaMode ? 'block' : 'none';
    document.getElementById('accelEngine').style.display = config.oddZetaMode ? 'block' : 'none';
    
    document.getElementById('clockTitle').textContent = `‚ü® ${dim}D SELF-VERIFIED TIME ‚ü©`;
    document.getElementById('ramosLabel').textContent = `RAMOS TIME (${config.rtSymbol})`;
    
    initInterfaceState();
    buildMathGrid();
    buildInterfacePanel();
    buildChannelArcs();
    resetState();
}

function buildMathGrid() {
    const config = DIMENSION_CONFIG[currentDimension];
    const grid = document.getElementById('mathGrid');
    let html = '';
    
    // Math sequences
    config.mathSequences.forEach(seq => {
        const info = MATH_INFO[seq];
        if (info) {
            const cellClass = seq.startsWith('zeta') ? 'zeta' : (seq === 'oddZeta' ? 'oddZeta' : seq);
            html += `<div class="math-cell ${cellClass}"><div class="math-value" id="${seq}Ratio">‚Äî</div><div class="math-label">${info.label}</div><div class="math-target">‚Üí ${info.targetStr}</div></div>`;
        }
    });
    
    // Semantic Grounding (protected)
    html += `<div class="math-cell semantic"><div class="math-value" id="semanticRatio">1.0</div><div class="math-label">Semantic</div><div class="math-target">‚Üí 1.0</div></div>`;
    
    // Identity (protected)
    html += `<div class="math-cell identity"><div class="math-value" id="identityRatio">1.0</div><div class="math-label">Identity</div><div class="math-target">‚Üí 1.0</div></div>`;
    
    // Œì* result
    html += `<div class="math-cell center"><div class="math-value" id="gammaValue">‚Äî</div><div class="math-label">${DIMENSION_CONFIG[currentDimension].symbol}</div><div class="math-target">‚Üí 1.0</div></div>`;
    
    grid.innerHTML = html;
}

function resetState() {
    n = 5;
    fPrevPrev = 3n; fPrev = 5n; fCurr = 8n;
    lPrevPrev = 4n; lPrev = 7n; lCurr = 11n;
    cPrev = 5n; cCurr = 14n;
    motzkinMemo = [1n, 1n, 2n, 4n, 9n, 21n];
    mPrevPrev = 4n; mPrev = 9n; mCurr = 21n;
    pPrevPrev = 5n; pPrev = 12n; pCurr = 29n;
    
    zetaSums = { 2: 0, 4: 0, 6: 0 };
    for (let k = 1; k <= 5; k++) {
        zetaSums[2] += 1 / (k * k);
        zetaSums[4] += 1 / Math.pow(k, 4);
        zetaSums[6] += 1 / Math.pow(k, 6);
    }
    
    oddZetaSums = { 3: 0, 5: 0, 7: 0, 9: 0 };
    oddZetaAccelerated = { 3: 0, 5: 0, 7: 0, 9: 0 };
    oddZetaHistory = { 3: [], 5: [], 7: [], 9: [] };
    oddZetaEMA = { 3: 0, 5: 0, 7: 0, 9: 0 };
    oddZetaStability = { 3: 0, 5: 0, 7: 0, 9: 0 };
    
    for (let k = 1; k <= 5; k++) {
        oddZetaSums[3] += 1 / Math.pow(k, 3);
        oddZetaSums[5] += 1 / Math.pow(k, 5);
        oddZetaSums[7] += 1 / Math.pow(k, 7);
        oddZetaSums[9] += 1 / Math.pow(k, 9);
    }
    [3, 5, 7, 9].forEach(s => { oddZetaEMA[s] = oddZetaSums[s]; });
    
    emaGamma = 1.0;
    lockStability = 0;
    gammaHistory = [];
    gammaLocked = false;
    gammaInvalid = false;
    accelMetrics = { phiLockFactor: 0, silverLockFactor: 0, gammaBoost: 0, accelRate: 0, convGain: 0 };
    
    initInterfaceState();
    
    document.getElementById('log').innerHTML = '';
    document.getElementById('gammaClock').classList.remove('gamma-locked', 'degraded-mode', 'invalid-mode');
    updateSystemStateBanner('valid', 'System initialized. Protected core intact.');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RUN LOOP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function run() {
    while (running) {
        const batchSize = n < 1000 ? 10 : n < 10000 ? 50 : 200;
        for (let i = 0; i < batchSize && running; i++) step();
        await new Promise(r => setTimeout(r, 16));
    }
}

function start() { 
    if (running) return; 
    resetState(); 
    running = true; 
    run(); 
}

function stop() { 
    running = false; 
}

// Initialize
setDimension(5);
</script>

</body>
</html>
